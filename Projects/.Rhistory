data_dir = '/Users/m.wehrens/Data/_2019_02_HCM_SCS/2021_HPC_analysis.3b/Rdata-important/'
# Load the data
Seurat_RooijOnly = readRDS(paste0(data_dir, 'H5_RHL_SeuratObject_nM_sel_ROOIJonly.sp.bt_RID2l_clExtended.Rds'))
data_dir = '/Users/m.wehrens/Data_Hubrecht/_2019_02_HCM_SCS/2021_HPC_analysis.3b/Rdata-important/'
Seurat_RooijOnly = readRDS(paste0(data_dir, 'H5_RHL_SeuratObject_nM_sel_ROOIJonly.sp.bt_RID2l_clExtended.Rds'))
DimPlot(Seurat_RooijOnly)
LOCAL=1; script_dir = '/Users/m.wehrens/Documents/git_repos/SCS_More_analyses/Projects/'; desired_command='dummy'; source(paste0(script_dir, 'HCM_SCS_2021_06_SeuratRevisedAnalysis_v2_UmiTools.R')); rm('desired_command')
LOCAL=1; script_dir = '/Users/m.wehrens/Documents/git_repos/_Hubrecht-n-before/SCS_More_analyses/Projects/'; desired_command='dummy'; source(paste0(script_dir, 'HCM_SCS_2021_06_SeuratRevisedAnalysis_v2_UmiTools.R')); rm('desired_command')
LOCAL=1; script_dir = '/Users/m.wehrens/Documents/git_repos/_Hubrecht-n-before/SCS_More_analyses/Projects/'; desired_command='dummy'; source(paste0(script_dir, 'HCM_SCS_2021_06_SeuratRevisedAnalysis_v2_UmiTools.R')); rm('desired_command')
Seurat_RooijOnly = readRDS(paste0(data_dir, 'H5_RHL_SeuratObject_nM_sel_ROOIJonly.sp.bt_RID2l_clExtended.Rds'))
DimPlot(Seurat_RooijOnly)
Seurat_RooijAll  = readRDS(paste0(data_dir, 'H5_RHL_SeuratObject_nM_sel_ALL.SP_btypSel_RID2l_clExtended.Rds'))
DimPlot(Seurat_RooijAll)
DATASET_NAME='ROOIJonly.sp.bt_RID2l'
ANALYSIS_NAME=DATASET_NAME
ANALYSIS_NAME_clExtended = paste0(DATASET_NAME, '_clExtended')
ANALYSIS_NAME_clExtended
final_filename = paste0('H5_RHL_SeuratObject_nM_sel_',ANALYSIS_NAME_clExtended,'.h5seurat')
current_analysis[[ANALYSIS_NAME_clExtended]] =
LoadH5Seurat(file = paste0(base_dir,'Rdata/',final_filename))
final_filename = paste0('H5_RHL_SeuratObject_nM_sel_',ANALYSIS_NAME_clExtended,'.h5seurat')
if (!exists('current_analysis')) {current_analysis = list()}
current_analysis[[ANALYSIS_NAME_clExtended]] =
LoadH5Seurat(file = paste0(base_dir,'Rdata/',final_filename))
base_dir
base_dir = '/Users/m.wehrens/Data_Hubrecht/_2019_02_HCM_SCS/2021_HPC_analysis.3b/'
current_analysis[[ANALYSIS_NAME_clExtended]] =
LoadH5Seurat(file = paste0(base_dir,'Rdata/',final_filename))
matrix_HCM_raw_big = as.matrix(current_analysis$ROOIJonly.sp.bt_RID2l_clExtended@assays$RNA@counts)
HCM_SCS_ids
dataset_list_paths_HCM
dataset_list_paths_HCM_filenameonly
dataset_list_paths_HCM_filenameonly = paste0(HCM_SCS_ids, '_pT.nonRibo_E99_Aligned.out.counts.table.tsv')
HCM_SCS_ids
dataset_list_paths_HCM_filenameonly = paste0(HCM_SCS_ids, '_pT.nonRibo_E99_Aligned.out.counts.table.tsv')
main_data_dir_sanitycheck = '/Users/m.wehrens/Data/_2019_02_HCM_SCS/2021_UmiTools_CountTables_Wang_HCMSCS/exclMulti_Filtered/ROOIJ/'
for (IDX in 1:length(HCM_SCS_ids)) {
print(names(HCM_SCS_ids)[IDX])
file_name = paste0(main_data_dir_sanitycheck, dataset_list_paths_HCM_filenameonly[IDX])
data = read.table(file_name, header=TRUE, row.names=1, sep=' ')
# make colnames consistent with seurat object data
colnames(data) = paste0(names(HCM_SCS_ids)[IDX], '_', colnames(data))
# make rownames consistent
# quick sanity check, count number of underscores per name
rownames_data = rownames(data)
all(sapply(rownames_data, str_count, '_')==1)
# now replace the underscore by a :
rownames(data) = gsub('_', ':', rownames_data)
# now for comparison, select the same cols and rows from both matrices
rownames_rawfile = rownames(data)
rownames_seurat = rownames(matrix_HCM_raw_big)
colnames_rawfile = colnames(data)
colnames_seurat = colnames(matrix_HCM_raw_big)
rownames_shared = intersect(rownames_rawfile, rownames_seurat)
colnames_shared = intersect(colnames_rawfile, colnames_seurat)
# now create the intersect subset
data_shared = data[rownames_shared, colnames_shared]
matrix_HCM_raw_big_shared = matrix_HCM_raw_big[rownames_shared, colnames_shared]
# now check whether they are the same
rowcount_shared = dim(data_shared)[1]
rowcount_seurat = dim(matrix_HCM_raw_big)[1]
all(data_shared == matrix_HCM_raw_big_shared)
if (all(data_shared == matrix_HCM_raw_big_shared)) {
print(paste0('check passed, nr of genes:', rowcount_shared,'/',rowcount_seurat)) }
else {
print('check failed') }
}
main_data_dir_sanitycheck = '/Users/m.wehrens/Data_Hubrecht/_2019_02_HCM_SCS/2021_UmiTools_CountTables_Wang_HCMSCS/exclMulti_Filtered/ROOIJ/'
for (IDX in 1:length(HCM_SCS_ids)) {
print(names(HCM_SCS_ids)[IDX])
file_name = paste0(main_data_dir_sanitycheck, dataset_list_paths_HCM_filenameonly[IDX])
data = read.table(file_name, header=TRUE, row.names=1, sep=' ')
# make colnames consistent with seurat object data
colnames(data) = paste0(names(HCM_SCS_ids)[IDX], '_', colnames(data))
# make rownames consistent
# quick sanity check, count number of underscores per name
rownames_data = rownames(data)
all(sapply(rownames_data, str_count, '_')==1)
# now replace the underscore by a :
rownames(data) = gsub('_', ':', rownames_data)
# now for comparison, select the same cols and rows from both matrices
rownames_rawfile = rownames(data)
rownames_seurat = rownames(matrix_HCM_raw_big)
colnames_rawfile = colnames(data)
colnames_seurat = colnames(matrix_HCM_raw_big)
rownames_shared = intersect(rownames_rawfile, rownames_seurat)
colnames_shared = intersect(colnames_rawfile, colnames_seurat)
# now create the intersect subset
data_shared = data[rownames_shared, colnames_shared]
matrix_HCM_raw_big_shared = matrix_HCM_raw_big[rownames_shared, colnames_shared]
# now check whether they are the same
rowcount_shared = dim(data_shared)[1]
rowcount_seurat = dim(matrix_HCM_raw_big)[1]
all(data_shared == matrix_HCM_raw_big_shared)
if (all(data_shared == matrix_HCM_raw_big_shared)) {
print(paste0('check passed, nr of genes:', rowcount_shared,'/',rowcount_seurat)) }
else {
print('check failed') }
}
print(names(HCM_SCS_ids)[IDX])
colnames(data)
rownames(matrix_HCM_raw_big)
colnames(matrix_HCM_raw_big)
colnames(data)
colnames(matrix_HCM_raw_big)[0]
colnames(matrix_HCM_raw_big)[1]
colnames(data)[1]
rownames(data)[1]
rownames_data = rownames(data)
all(sapply(rownames_data, str_count, '_')==1)
sapply(rownames_data, str_count, '_')
rownames(data)[1]
rownames(data)
matrix_HCM_raw_big_shared
c('JE01'='R.P1', 'JE02'='R.P1', 'JE03'='R.P1', 'JE04'='R.P1',
'JE05'='R.P2', 'JE06'='R.P2', 'JE07'='R.P2', 'JE08'='R.P2',
'MW05'='R.P3', 'MW06'='R.P3', 'MW07'='R.P3', 'MW08'='R.P3',
'JE10'='R.P4', 'JE11'='R.P4',
'AL01'='R.P5', 'AL02'='R.P5')
t(c('JE01'='R.P1', 'JE02'='R.P1', 'JE03'='R.P1', 'JE04'='R.P1',
'JE05'='R.P2', 'JE06'='R.P2', 'JE07'='R.P2', 'JE08'='R.P2',
'MW05'='R.P3', 'MW06'='R.P3', 'MW07'='R.P3', 'MW08'='R.P3',
'JE10'='R.P4', 'JE11'='R.P4',
'AL01'='R.P5', 'AL02'='R.P5'))
c('JE01'='R.P1', 'JE02'='R.P1', 'JE03'='R.P1', 'JE04'='R.P1',
'JE05'='R.P2', 'JE06'='R.P2', 'JE07'='R.P2', 'JE08'='R.P2',
'MW05'='R.P3', 'MW06'='R.P3', 'MW07'='R.P3', 'MW08'='R.P3',
'JE10'='R.P4', 'JE11'='R.P4',
'AL01'='R.P5', 'AL02'='R.P5')
Rooij_conversion_pts = c('JE01'='R.P1', 'JE02'='R.P1', 'JE03'='R.P1', 'JE04'='R.P1',
'JE05'='R.P2', 'JE06'='R.P2', 'JE07'='R.P2', 'JE08'='R.P2',
'MW05'='R.P3', 'MW06'='R.P3', 'MW07'='R.P3', 'MW08'='R.P3',
'JE10'='R.P4', 'JE11'='R.P4',
'AL01'='R.P5', 'AL02'='R.P5')
simple_overview_table_samples = data.frame(sample = Rooij_conversion_pts, sample_id = names(Rooij_conversion_pts))
simple_overview_table_samples
simple_overview_table_samples = data.frame(sample = Rooij_conversion_pts)
simple_overview_table_samples
data.frame(sample = Rooij_conversion_pts)
dim(data.frame(sample = Rooij_conversion_pts))
current_analysis$ROOIJonly.sp.bt_RID2l_clExtended$annotation_patient_str
current_analysis$ROOIJonly.sp.bt_RID2l_clExtended$orig.ident[1]
Rooij_conversion_pts[current_analysis$ROOIJonly.sp.bt_RID2l_clExtended$orig.ident]
Rooij_conversion_pts.plt = c('JE01'='R.P1.plt1', 'JE02'='R.P1.plt2', 'JE03'='R.P1.plt3', 'JE04'='R.P1.plt4',
'JE05'='R.P2.plt1', 'JE06'='R.P2.plt2', 'JE07'='R.P2.plt3', 'JE08'='R.P2.plt4',
'MW05'='R.P3.plt1', 'MW06'='R.P3.plt2', 'MW07'='R.P3.plt3', 'MW08'='R.P3.plt4',
'JE10'='R.P4.plt1', 'JE11'='R.P4.plt2',
'AL01'='R.P5.plt1', 'AL02'='R.P5.plt2')
current_analysis$ROOIJonly.sp.bt_RID2l_clExtended$patient.plate_fct =
factor(Rooij_conversion_pts.plt[current_analysis$ROOIJonly.sp.bt_RID2l_clExtended$orig.ident],
levels=Rooij_conversion_pts.plt)
current_analysis$ROOIJonly.sp.bt_RID2l_clExtended$nCount.nMT
ggplot(current_analysis$ROOIJonly.sp.bt_RID2l_clExtended@meta.data, aes(x=patient.plate_fct, y=nCount.nMT))+
geom_histogram()
ggplot(current_analysis$ROOIJonly.sp.bt_RID2l_clExtended@meta.data, aes(x=patient.plate_fct, y=nCount.nMT))+
geom_histogram(stat='identity')
ggplot(current_analysis$ROOIJonly.sp.bt_RID2l_clExtended@meta.data, aes(x=patient.plate_fct, y=nCount.nMT))+
geom_histogram(stat='identity')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
Rooij_conversion_pts.plt
length(Rooij_conversion_pts.plt)
HCM_SCS_ids
data.frame(HCM_SCS_ids)
main_data_dir_sanitycheck
# Load the first table
for (IDX in 1:length(HCM_SCS_ids)) {
# IDX=3
print(names(HCM_SCS_ids)[IDX])
file_name = paste0(main_data_dir_sanitycheck, dataset_list_paths_HCM_filenameonly[IDX])
data = read.table(file_name, header=TRUE, row.names=1, sep=' ')
# make colnames consistent with seurat object data
colnames(data) = paste0(names(HCM_SCS_ids)[IDX], '_', colnames(data))
# make rownames consistent
# quick sanity check, count number of underscores per name
rownames_data = rownames(data)
all(sapply(rownames_data, str_count, '_')==1)
# now replace the underscore by a :
rownames(data) = gsub('_', ':', rownames_data)
# now for comparison, select the same cols and rows from both matrices
# rownames
rownames_rawfile = rownames(data)
rownames_seurat = rownames(matrix_HCM_raw_big)
# colnames
colnames_rawfile = colnames(data)
colnames_seurat = colnames(matrix_HCM_raw_big)
# intersect col and rownames
rownames_shared = intersect(rownames_rawfile, rownames_seurat)
colnames_shared = intersect(colnames_rawfile, colnames_seurat)
if (length(colnames_rawfile) == length(colnames_seurat)) { print('All cells accounted for.') }
# now create the intersect subset
data_shared = data[rownames_shared, colnames_shared]
matrix_HCM_raw_big_shared = matrix_HCM_raw_big[rownames_shared, colnames_shared]
# now check whether they are the same
rowcount_shared = dim(data_shared)[1]
rowcount_seurat = dim(matrix_HCM_raw_big)[1]
all(data_shared == matrix_HCM_raw_big_shared)
if (all(data_shared == matrix_HCM_raw_big_shared)) {
print(paste0('check passed, nr of genes:', rowcount_shared,'/',rowcount_seurat)) }
else {
print('check failed') }
}
length(colnames_rawfile)
length(colnames_seurat)
2292/384
